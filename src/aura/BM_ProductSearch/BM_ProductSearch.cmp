<!--
 - Created by Dawid MajdaÅ„ski on 31.01.2019.
 -->

<aura:component description="BM_CustomProductSearch" implements="forceCommunity:searchInterface"
                controller="BM_ProductSearchController">
    <ltng:require styles="/resource/dontDisplayLogo"/>
    <aura:attribute name="isAdvSearchDisplayed" type="Boolean" default="false"/>
    <aura:attribute name="searchText" type="String" default=""/>
    <aura:attribute name="minPrice" type="Decimal"/>
    <aura:attribute name="maxPrice" type="Decimal"/>
    <aura:attribute name="minRating" type="Integer"/>
    <aura:attribute name="specificYear" type="Integer"/>
    <aura:attribute name="minYear" type="Integer"/>
    <aura:attribute name="maxYear" type="Integer"/>
    <aura:attribute name="bookGenre" type="String"/>
    <aura:attribute name="movieGenre" type="String"/>
    <aura:attribute name="bookGenres" type="String[]"/>
    <aura:attribute name="movieGenres" type="String[]"/>
    <aura:attribute name="author" type="String"/>
    <aura:attribute name="director" type="String"/>
    <aura:attribute name="productType" type="String" default="AllTab"/>
    <aura:attribute name="cartItemsQuantity" type="Integer" default="0"/>
    <aura:handler name="init" value="{!this}" action="{!c.init}"/>
    <aura:handler event="c:BM_ProductsCartQuantityEvent" action="{!c.handleUpdateCartProductsQuantity}"/>

    <div class="slds-form-element slds-lookup" data-select="single">
        <div class="slds-form-element__control">
            <div class="slds-input-has-icon slds-input-has-icon--right">
                <lightning:buttonIcon iconName="utility:search" variant="bare" onclick="{! c.handleClick }"
                                      alternativeText="Search" class="slds-input__icon"/>
                <ui:inputText value="{!v.searchText}" class="slds-lookup__search-input slds-input"
                              placeholder="Search"/>
            </div>
            <div id="arrowDiv" class="arrowContainer" title="Advanced search"
                 onclick="{!c.onAdvancedSearchModalAppearance}">
                <lightning:icon iconName="utility:chevronleft" class="iconPosition"/>
            </div>

            <div class="cartContainer" onclick="{!c.handleProductsInCart}">
                <img class="cartIco" src="{!$Resource.CartIcon}" />
                <aura:if isTrue="{!v.cartItemsQuantity>0}">
                    <span class="cartItemsQuantity">{!v.cartItemsQuantity}</span>
                </aura:if>
            </div>
            <div id="advSearchModal" class="advancedSearchDiv hideModal">
                <lightning:tabset class="advSearchModalTabset" selectedTabId="{!v.productType}" onselect="{!c.handleChangeTabset}">
                    <lightning:tab label="All" id="AllTab">
                        <div class="slds-form-element tabsetPadding">
                            <c:BM_ProductSearchSharedParams aura:id="clearAvailableYears" specificYear="{!v.specificYear}" minYear="{!v.minYear}"
                                                            maxYear="{!v.maxYear}" minPrice="{!v.minPrice}"
                                                            maxPrice="{!v.maxPrice}"/>
                        </div>
                    </lightning:tab>
                    <lightning:tab label="Books" id="BookTab">
                        <div class="slds-form-element tabsetPadding">
                            <c:BM_ProductSearchSharedParams aura:id="clearAvailableYears1" specificYear="{!v.specificYear}" minYear="{!v.minYear}"
                                                            maxYear="{!v.maxYear}" minPrice="{!v.minPrice}"
                                                            maxPrice="{!v.maxPrice}"/>
                            <div id="book_genre_param" class="searchParamsGridStyle">
                                <lightning:select aura:id="selectBookGenre" name="selectBookGenre" label="Genre" onchange="{!c.handleBookGenreChange}">
                                    <option value="">All genres</option>
                                    <aura:iteration items="{!v.bookGenres}" var="genre" >
                                        <option>{!genre}</option>
                                    </aura:iteration>
                                </lightning:select>
                            </div>
                            <div id="book_author_param" class="searchParamsGridStyle">
                                <lightning:input label="Author" class="input_Param" type="text" value="{!v.author}" />
                            </div>
                        </div>
                    </lightning:tab>
                    <lightning:tab label="Movies" id="MovieTab">
                        <div class="slds-form-element tabsetPadding">
                            <c:BM_ProductSearchSharedParams aura:id="clearAvailableYears2" specificYear="{!v.specificYear}" minYear="{!v.minYear}"
                                                            maxYear="{!v.maxYear}" minPrice="{!v.minPrice}"
                                                            maxPrice="{!v.maxPrice}"/>
                            <div id="movie_genre_param" class="searchParamsGridStyle">
                                <lightning:select aura:id="selectMovieGenre" name="selectMovieGenre" label="Genre" onchange="{!c.handleMovieGenreChange}">
                                    <option value="">All genres</option>
                                    <aura:iteration items="{!v.movieGenres}" var="genre" >
                                        <option>{!genre}</option>
                                    </aura:iteration>>
                                </lightning:select>
                            </div>
                            <div id="director_param" class="searchParamsGridStyle">
                                <lightning:input label="Director" class="input_Param" type="text" value="{!v.director}" />
                            </div>
                        </div>
                    </lightning:tab>
                </lightning:tabset>

                <div onclick="{! c.handleClearParams}">
                    <lightning:icon iconName="utility:clear" title="Clear search" class="custom-slds-icon-clear"
                                    size="x-small"/>
                </div>
                <div onclick="{! c.handleClick }">
                    <lightning:icon iconName="utility:search" title="Search" class="custom-slds-icon-search"
                                    size="x-small"/>
                </div>

            </div>
        </div>
    </div>
</aura:component>