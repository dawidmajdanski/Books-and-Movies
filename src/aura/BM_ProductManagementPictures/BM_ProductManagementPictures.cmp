<!--
 - Created by Majdan on 25.02.2019.
 -->

<aura:component description="BM_ProductManagementPictures" controller="BM_ProductManagement">
    <aura:attribute name="products" type="Product2[]"/>
    <aura:attribute name="productSelected" type="Boolean"/>
    <aura:attribute name="productPictures" type="Object[]"/>
    <aura:attribute name="parentId" type="Id"/>
    <aura:attribute name="fileName" type="String" default="No File Selected.."/>
    <aura:attribute name="disabled" type="Boolean" default="false"/>

    <aura:handler name="init" value="{!this}" action="{!c.init}"/>

    <c:BM_Toast aura:id="toastMsg"/>

    <div style="padding: 1rem">
        <lightning:select aura:id="productsList" label="{!$Label.c.Products}" name="selectType"
                          onchange="{!c.handleSelectProduct}">
            <option value="">{!$Label.c.Select_product_option}</option>
            <aura:iteration items="{!v.products}" var="product">
                <option value="{!product.Id}">{!product.Name}</option>
            </aura:iteration>
        </lightning:select>
    </div>

    <div style="padding: 1rem; display: inline-block; width: 100%;">
        <aura:iteration items="{!v.productPictures}" var="pic">
            <aura:if isTrue="{!pic.pictureName!=$Label.c.Main_picture_name}">
                <div class="tileOuterDiv" title="{!$Label.c.Set_main_pic_hint}">
                    <img class="tileImg"
                         src="{!pic.pictureURL}" onclick="{!c.onSetMainPicture}"
                         data-record="{!pic.pictureId}"/>
                    <div class="delIcoContainer" title="{!$Label.c.Delete}" onclick="{!c.onDeletePicture}"
                         data-record="{!pic.pictureId}">
                        <lightning:icon iconName="action:delete" class="delIco" size="xx-small"/>
                    </div>
                </div>
            </aura:if>
            <aura:if isTrue="{!pic.pictureName==$Label.c.Main_picture_name}">
                <div class="tileOuterDivBordered" title="{!$Label.c.Main_picture}">
                    <img class="tileImg"
                         src="{!pic.pictureURL}"/>
                    <div class="delIcoContainerBordered" title="{!$Label.c.Delete}"
                         onclick="{!c.onDeletePicture}"
                         data-record="{!pic.pictureId}">
                        <lightning:icon iconName="action:delete" class="delIco" size="xx-small"/>
                    </div>
                </div>
            </aura:if>
        </aura:iteration>
    </div>

    <aura:if isTrue="{!v.productSelected}">
        <div style="padding: 1rem">
            <lightning:input aura:id="fileId" onchange="{!c.handleFilesChange}" type="file" name="file"
                             label="{!$Label.c.Upload_picture}" multiple="true" disabled="{!v.disabled}"/>
            <div class="slds-text-body_small slds-text-color_error">{!v.fileName} </div>
            <button class="slds-button slds-button_brand" style="margin-top:10px" onclick="{!c.doSave}">
                    {!$Label.c.Save}
            </button>
        </div>
    </aura:if>

</aura:component>