<!--
 - Created by Dawid MajdaÅ„ski on 08.02.2019.
 -->

<aura:component description="BM_ProductCart" implements="forceCommunity:availableForAllPageTypes"
                controller="BM_ProductSearchController">
    <aura:attribute type="Object[]" name="cartProducts"/>
    <aura:attribute type="User" name="user" />
    <aura:attribute type="Decimal" name="totalCartPrice" />
    <aura:handler name="init" value="{!this}" action="{!c.init}"/>

    <div class="cartContainer">
        <aura:if isTrue="{!v.cartProducts.length==0}">
            <p style="font-style: italic; font-size: 140%; text-align: center; padding-top: 2.5rem; padding-bottom: 2.5rem">
                Currently you have no products in your cart
            </p>
        </aura:if>
        <aura:if isTrue="{!v.cartProducts.length>0}">
            <div class="titleCart">
                Your cart
            </div>
            <aura:iteration items="{!v.cartProducts}" var="cartProduct" indexVar="ind">
                <div class="cartProductTile">
                    <div class="cartProductTileImgContainer">
                        <img class="cartProductTileImg" src="{!cartProduct.productMainPic}" />
                    </div>
                    <div class="cartProductInfo">
                            <span style="font-size: 170%;">{!cartProduct.productName}</span>
                            <p style="font-weight: bold; font-size:110%; padding-top:5px">{!cartProduct.quantity}x &nbsp;
                                <aura:if isTrue="{!cartProduct.discountPrice!=null}" >
                                    <span style="color: green">{!cartProduct.discountPrice}$</span>
                                </aura:if>
                                <aura:if isTrue="{!cartProduct.discountPrice==null}" >
                                    {!cartProduct.productPrice}$
                                </aura:if>
                            </p>
                            <div class="slds-form-element" style="padding-top:5px">
                                <label class="slds-form-element__label" for="text-input-id-1">Quantity</label>
                                <div class="slds-form-element__control">
                                    <input id="{!ind}" class="slds-input quantityInput" type="number" data-index="{!ind}" data-record="{!cartProduct.productId}" onblur="{!c.handleQuantityChange}" title="Quantity" value="{!cartProduct.quantity}" />
                                </div>
                            </div>
                    </div>
                    <div class="removeProduct" onclick="{!c.handleRemoveFromCart}" data-index="{!ind}" data-record="{!cartProduct.productId}">
                        <lightning:icon title="Remove from cart" iconName="utility:delete" size="large"  />
                    </div>
                </div>
            </aura:iteration>
            <div style="background-color: aquamarine;" class="bottomCartInfo">
            </div>
                <div class="totalPriceInfo">
                    Total price: {!v.totalCartPrice}$
                </div>
            <div class="bottomCartInfo">
                <button id="proceedToDelivery" style="margin-top: 6px;" onclick="{!c.handleGoToDeliveryPage}" class="slds-button slds-button_success proceedBtn">Proceed to delivery options</button>
            </div>
        </aura:if>
    </div>

</aura:component>